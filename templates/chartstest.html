<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Intake Chart</title>
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    <style>
        /* Center the text inside the chart */
        #waterIntakeValue {
            position: absolute;
            text-align: center;
            font-size: 24px;  /* Adjust font size as needed */
            font-weight: bold;
            color: #000;  /* Change color if needed */
            top: 50%;  /* Center vertically */
            left: 50%;  /* Center horizontally */
            transform: translate(-50%, -50%);  /* Shift back half of its own width and height */
        }
    </style>
</head>
<body>
    <div style="position: relative;">
        <div id="waterIntakeChart" style="height: 370px; width: 100%;"></div>
        <div id="waterIntakeValue"></div> <!-- This will hold the water intake value -->
    </div>

    <script>
        window.onload = function () {
            // Get chart data from the Flask view (injected via Jinja2 templating)
            const waterIntake = {{ chart_data['water_intake'] | tojson }};  // Convert to JSON to ensure it's safe for JS
            const totalWaterGoal = {{ chart_data['total_water_goal'] | tojson }};  // Convert to JSON for safety
            const remainingWater = totalWaterGoal - waterIntake; // Calculate remaining water

            var chart = new CanvasJS.Chart("waterIntakeChart", {
                title: {
                    text: "Water Intake Progress"
                },
                data: [{
                    type: "doughnut",
                    dataPoints: [
                        { y: waterIntake, indexLabel: "Water Intake (ml)" },
                        { y: remainingWater, indexLabel: "Remaining (ml)" }
                    ]
                }]
            });
            
            chart.render();

            // Display the water intake value in the center of the chart
            document.getElementById('waterIntakeValue').innerText = `${waterIntake} %`;  // Set the text
        };
    </script>
</body>
</html>
